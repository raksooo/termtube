{"version":3,"sources":["../../src/ui/feed.jsx"],"names":["Feed","props","context","checked","current","_createRow","bind","_onKeyPress","_onSelectItem","_setAutoSelected","videos","data","autoSelected","map","index","video","moreRecent","filter","o","setState","author","title","state","includes","key","checkedIndex","indexOf","splice","push","selectedVideos","maxDate","Date","isoDate","reduce","acc","_resetAutoSelected","item","rows","selected","fg","React","Component","propTypes","PropTypes","array","isRequired"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;IAEaA,I;;;;;AAOX,gBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAAA;;AAAA;;AAC1B,8EAAMD,KAAN,EAAaC,OAAb;;AAD0B,oFALpB;AACNC,MAAAA,OAAO,EAAE,EADH;AAENC,MAAAA,OAAO,EAAE;AAFH,KAKoB;;AAG1B,UAAKC,UAAL,GAAkB,MAAKA,UAAL,CAAgBC,IAAhB,uDAAlB;AACA,UAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBD,IAAjB,uDAAnB;AACA,UAAKE,aAAL,GAAqB,MAAKA,aAAL,CAAmBF,IAAnB,uDAArB;AAEA,kBAAI,kBAAJ;AAP0B;AAQ3B;;;;wCAEmB;AAClB,WAAKG,gBAAL;AACD;;;uCAEkB;AAAA,UAETC,MAFS,GAGb,KAAKT,KAHQ,CAEfU,IAFe;AAKjB,UAAMC,YAAY,GAAGF,MAAM,CACxBG,GADkB,CACd,gBAAwBC,KAAxB;AAAA,YAAGC,KAAH,QAAGA,KAAH;AAAA,YAAUC,UAAV,QAAUA,UAAV;AAAA,eAAmC;AAAED,UAAAA,KAAK,EAALA,KAAF;AAASD,UAAAA,KAAK,EAALA,KAAT;AAAgBE,UAAAA,UAAU,EAAVA;AAAhB,SAAnC;AAAA,OADc,EAElBC,MAFkB,CAEX;AAAA,YAAGD,UAAH,SAAGA,UAAH;AAAA,eAAoBA,UAApB;AAAA,OAFW,EAGlBH,GAHkB,CAGd,UAAAK,CAAC;AAAA,eAAIA,CAAC,CAACJ,KAAN;AAAA,OAHa,CAArB;AAKA,WAAKK,QAAL,CAAc;AAAEhB,QAAAA,OAAO,EAAES;AAAX,OAAd;AACD;;;yCAEoB;AACnB,WAAKO,QAAL,CAAc;AAAEhB,QAAAA,OAAO,EAAE;AAAX,OAAd;AACD;;;sCAEuCW,K,EAAO;AAAA,8BAAlCC,KAAkC;AAAA,UAAzBK,MAAyB,eAAzBA,MAAyB;AAAA,UAAjBC,KAAiB,eAAjBA,KAAiB;AAAA,UAE3ClB,OAF2C,GAGzC,KAAKmB,KAHoC,CAE3CnB,OAF2C;AAK7C,wBAAWA,OAAO,CAACoB,QAAR,CAAiBT,KAAjB,IAA0B,GAA1B,GAAgC,GAA3C,cAAkDM,MAAlD,gBAA8DC,KAA9D;AACD;;;gCAEWG,G,EAAK;AAAA,UAEPd,MAFO,GAGX,KAAKT,KAHM,CAEbU,IAFa;AAAA,wBAQX,KAAKW,KARM;AAAA,UAMblB,OANa,eAMbA,OANa;AAAA,UAObD,OAPa,eAObA,OAPa;;AAUf,UAAIqB,GAAG,KAAK,GAAZ,EAAiB;AACf,YAAMC,YAAY,GAAGtB,OAAO,CAACuB,OAAR,CAAgBtB,OAAhB,CAArB;;AACA,YAAIqB,YAAY,GAAG,CAAC,CAApB,EAAuB;AACrBtB,UAAAA,OAAO,CAACwB,MAAR,CAAeF,YAAf,EAA6B,CAA7B;AACA,eAAKN,QAAL,CAAc;AAAEhB,YAAAA,OAAO,EAAPA;AAAF,WAAd;AACD,SAHD,MAGO;AACLA,UAAAA,OAAO,CAACyB,IAAR,CAAaxB,OAAb;AACA,eAAKe,QAAL,CAAc;AAAEhB,YAAAA,OAAO,EAAPA;AAAF,WAAd;AACD;AACF,OATD,MASO,IAAIqB,GAAG,KAAK,GAAZ,EAAiB;AACtB,YAAMK,cAAc,GAAG1B,OAAO,CAACU,GAAR,CAAY,UAAAC,KAAK;AAAA,iBAAIJ,MAAM,CAACI,KAAD,CAAN,CAAcC,KAAlB;AAAA,SAAjB,CAAvB;AACA,gCAAWc,cAAX;AAEA,YAAIC,OAAO,GAAGD,cAAc,CACzBhB,GADW,CACP,UAAAE,KAAK;AAAA,iBAAI,IAAIgB,IAAJ,CAAShB,KAAK,CAACiB,OAAf,CAAJ;AAAA,SADE,EAEXC,MAFW,CAEJ,UAACC,GAAD,EAAM9B,OAAN;AAAA,iBAAkB8B,GAAG,GAAG9B,OAAN,GAAgB8B,GAAhB,GAAsB9B,OAAxC;AAAA,SAFI,CAAd;AAGA,6CAAiB0B,OAAjB;;AACA,aAAKK,kBAAL;AACD,OATM,MASA,IAAIX,GAAG,KAAK,GAAZ,EAAiB;AACtB,YAAMT,KAAK,GAAGL,MAAM,CAACN,OAAD,CAAN,CAAgBW,KAA9B;AACA,gCAAW,CAACA,KAAD,CAAX;AACD;AACF;;;kCAEaqB,I,EAAM;AAClB,UAAMtB,KAAK,GAAGsB,IAAI,CAACtB,KAAL,GAAa,CAA3B;AACA,WAAKK,QAAL,CAAc;AAAEf,QAAAA,OAAO,EAAEU;AAAX,OAAd;AACD;;;6BAEQ;AACP,oBAAI,aAAJ;AADO,UAGCJ,MAHD,GAIH,KAAKT,KAJF,CAGLU,IAHK;AAMP,UAAM0B,IAAI,GAAG3B,MAAM,CAChBG,GADU,CACN,KAAKR,UADC,CAAb;AAGA,aACE;AACE,QAAA,KAAK,EAAEgC,IADT;AAEE,QAAA,UAAU,EAAE,KAAK9B,WAFnB;AAGE,QAAA,YAAY,EAAE,KAAKC,aAHrB;AAIE,QAAA,KAAK,EAAE;AAAE8B,UAAAA,QAAQ,EAAE;AAAEC,YAAAA,EAAE,EAAE;AAAN;AAAZ,SAJT;AAKE,QAAA,IAAI,EAAE,KALR;AAME,QAAA,IAAI,MANN;AAOE,QAAA,EAAE,MAPJ;AAQE,QAAA,OAAO;AART,QADF;AAYD;;;;EA1GuBC,eAAMC,S;;;AA6GhCzC,IAAI,CAAC0C,SAAL,GAAiB;AACf/B,EAAAA,IAAI,EAAEgC,mBAAUC,KAAV,CAAgBC;AADP,CAAjB","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { trySetMostRecent } from '../configHandler';\nimport { playVideos } from '../player';\nimport { log } from '../log';\n\nexport class Feed extends React.Component {\n\n  state = {\n    checked: [],\n    current: 0,\n  }\n\n  constructor(props, context) {\n    super(props, context);\n\n    this._createRow = this._createRow.bind(this);\n    this._onKeyPress = this._onKeyPress.bind(this);\n    this._onSelectItem = this._onSelectItem.bind(this);\n\n    log('Feed constructor');\n  }\n\n  componentDidMount() {\n    this._setAutoSelected();\n  }\n\n  _setAutoSelected() {\n    const {\n      data: videos,\n    } = this.props;\n\n    const autoSelected = videos\n      .map(({ video, moreRecent }, index) => ({ video, index, moreRecent }))\n      .filter(({ moreRecent }) => moreRecent)\n      .map(o => o.index);\n\n    this.setState({ checked: autoSelected });\n  }\n\n  _resetAutoSelected() {\n    this.setState({ checked: [] });\n  }\n\n  _createRow({ video: { author, title }}, index) {\n    const {\n      checked,\n    } = this.state;\n\n    return ` ${checked.includes(index) ? 'âœ”' : ' '} ${author} - ${title}`;\n  }\n\n  _onKeyPress(key) {\n    const {\n      data: videos,\n    } = this.props;\n\n    const {\n      current,\n      checked,\n    } = this.state;\n\n    if (key === ' ') {\n      const checkedIndex = checked.indexOf(current);\n      if (checkedIndex > -1) {\n        checked.splice(checkedIndex, 1);\n        this.setState({ checked });\n      } else {\n        checked.push(current);\n        this.setState({ checked });\n      }\n    } else if (key === 'p') {\n      const selectedVideos = checked.map(index => videos[index].video);\n      playVideos(selectedVideos);\n\n      var maxDate = selectedVideos\n        .map(video => new Date(video.isoDate))\n        .reduce((acc, current) => acc > current ? acc : current);\n      trySetMostRecent(maxDate);\n      this._resetAutoSelected();\n    } else if (key === 'o') {\n      const video = videos[current].video;\n      playVideos([video]);\n    }\n  }\n\n  _onSelectItem(item) {\n    const index = item.index - 2;\n    this.setState({ current: index });\n  }\n\n  render() {\n    log('Feed render');\n    const {\n      data: videos,\n    } = this.props;\n\n    const rows = videos\n      .map(this._createRow);\n\n    return (\n      <list\n        items={rows}\n        onKeypress={this._onKeyPress}\n        onSelectItem={this._onSelectItem}\n        style={{ selected: { fg: 'green' }}}\n        data={\"foo\"}\n        keys\n        vi\n        focused\n      />\n    );\n  }\n}\n\nFeed.propTypes = {\n  data: PropTypes.array.isRequired,\n}\n\n"],"file":"feed.js"}